
{
    "name": "GTD_MappingFlow",
    "properties": {
        "type": "MappingDataFlow",
        "typeProperties": {
            "sources": [
                {
                    "dataset": {
                        "referenceName": "GTD_CSV_Dataset",
                        "type": "DatasetReference"
                    },
                    "name": "source1"
                }
            ],
            "sinks": [
                {
                    "dataset": {
                        "referenceName": "GTD_SQL_Sink",
                        "type": "DatasetReference"
                    },
                    "name": "gtdsink"
                }
            ],
            "transformations": [
                {
                    "name": "FixTypes"
                }
            ],
            "scriptLines": [
                "source(output(",
                "          eventid as string,",
                "          iyear as string,",
                "          imonth as string,",
                "          iday as string,",
                "          approxdate as string,",
                "          extended as string,",
                "          resolution as string,",
                "          country as string,",
                "          country_txt as string,",
                "          region as string,",
                "          region_txt as string,",
                "          provstate as string,",
                "          city as string,",
                "          latitude as string,",
                "          longitude as string,",
                "          specificity as string,",
                "          vicinity as string,",
                "          location as string,",
                "          summary as string,",
                "          crit1 as string,",
                "          crit2 as string,",
                "          crit3 as string,",
                "          doubtterr as string,",
                "          alternative as string,",
                "          alternative_txt as string,",
                "          multiple as string,",
                "          success as string,",
                "          suicide as string,",
                "          attacktype1 as string,",
                "          attacktype1_txt as string,",
                "          attacktype2 as string,",
                "          attacktype2_txt as string,",
                "          attacktype3 as string,",
                "          attacktype3_txt as string,",
                "          targtype1 as string,",
                "          targtype1_txt as string,",
                "          targsubtype1 as string,",
                "          targsubtype1_txt as string,",
                "          corp1 as string,",
                "          target1 as string,",
                "          natlty1 as string,",
                "          natlty1_txt as string,",
                "          targtype2 as string,",
                "          targtype2_txt as string,",
                "          targsubtype2 as string,",
                "          targsubtype2_txt as string,",
                "          corp2 as string,",
                "          target2 as string,",
                "          natlty2 as string,",
                "          natlty2_txt as string,",
                "          targtype3 as string,",
                "          targtype3_txt as string,",
                "          targsubtype3 as string,",
                "          targsubtype3_txt as string,",
                "          corp3 as string,",
                "          target3 as string,",
                "          natlty3 as string,",
                "          natlty3_txt as string,",
                "          gname as string,",
                "          gsubname as string,",
                "          gname2 as string,",
                "          gsubname2 as string,",
                "          gname3 as string,",
                "          gsubname3 as string,",
                "          motive as string,",
                "          guncertain1 as string,",
                "          guncertain2 as string,",
                "          guncertain3 as string,",
                "          individual as string,",
                "          nperps as string,",
                "          nperpcap as string,",
                "          claimed as string,",
                "          claimmode as string,",
                "          claimmode_txt as string,",
                "          claim2 as string,",
                "          claimmode2 as string,",
                "          claimmode2_txt as string,",
                "          claim3 as string,",
                "          claimmode3 as string,",
                "          claimmode3_txt as string,",
                "          compclaim as string,",
                "          weaptype1 as string,",
                "          weaptype1_txt as string,",
                "          weapsubtype1 as string,",
                "          weapsubtype1_txt as string,",
                "          weaptype2 as string,",
                "          weaptype2_txt as string,",
                "          weapsubtype2 as string,",
                "          weapsubtype2_txt as string,",
                "          weaptype3 as string,",
                "          weaptype3_txt as string,",
                "          weapsubtype3 as string,",
                "          weapsubtype3_txt as string,",
                "          weaptype4 as string,",
                "          weaptype4_txt as string,",
                "          weapsubtype4 as string,",
                "          weapsubtype4_txt as string,",
                "          weapdetail as string,",
                "          nkill as string,",
                "          nkillus as string,",
                "          nkillter as string,",
                "          nwound as string,",
                "          nwoundus as string,",
                "          nwoundte as string,",
                "          property as string,",
                "          propextent as string,",
                "          propextent_txt as string,",
                "          propvalue as string,",
                "          propcomment as string,",
                "          ishostkid as string,",
                "          nhostkid as string,",
                "          nhostkidus as string,",
                "          nhours as string,",
                "          ndays as string,",
                "          divert as string,",
                "          kidhijcountry as string,",
                "          ransom as string,",
                "          ransomamt as string,",
                "          ransomamtus as string,",
                "          ransompaid as string,",
                "          ransompaidus as string,",
                "          ransomnote as string,",
                "          hostkidoutcome as string,",
                "          hostkidoutcome_txt as string,",
                "          nreleased as string,",
                "          addnotes as string,",
                "          scite1 as string,",
                "          scite2 as string,",
                "          scite3 as string,",
                "          dbsource as string,",
                "          INT_LOG as string,",
                "          INT_IDEO as string,",
                "          INT_MISC as string,",
                "          INT_ANY as string,",
                "          related as string",
                "     ),",
                "     allowSchemaDrift: false,",
                "     validateSchema: false,",
                "     ignoreNoFilesFound: false) ~> source1",
                "source1 derive(event_date = toDate(concat(iyear, '-', imonth, '-', iday), 'yyyy-M-d'),",
                "          nkill = toInteger(nkill),",
                "          nwound = toInteger(nwound),",
                "          longitude = toFloat(longitude),",
                "          latitude = toFloat(latitude)) ~> FixTypes",
                "FixTypes sink(allowSchemaDrift: true,",
                "     validateSchema: false,",
                "     input(",
                "          eventid as string,",
                "          iyear as string,",
                "          imonth as string,",
                "          iday as string,",
                "          approxdate as string,",
                "          extended as string,",
                "          resolution as string,",
                "          country as string,",
                "          country_txt as string,",
                "          region as string,",
                "          region_txt as string,",
                "          provstate as string,",
                "          city as string,",
                "          latitude as string,",
                "          longitude as string,",
                "          specificity as string,",
                "          vicinity as string,",
                "          location as string,",
                "          summary as string,",
                "          crit1 as string,",
                "          crit2 as string,",
                "          crit3 as string,",
                "          doubtterr as string,",
                "          alternative as string,",
                "          alternative_txt as string,",
                "          multiple as string,",
                "          success as string,",
                "          suicide as string,",
                "          attacktype1 as string,",
                "          attacktype1_txt as string,",
                "          attacktype2 as string,",
                "          attacktype2_txt as string,",
                "          attacktype3 as string,",
                "          attacktype3_txt as string,",
                "          targtype1 as string,",
                "          targtype1_txt as string,",
                "          targsubtype1 as string,",
                "          targsubtype1_txt as string,",
                "          corp1 as string,",
                "          target1 as string,",
                "          natlty1 as string,",
                "          natlty1_txt as string,",
                "          targtype2 as string,",
                "          targtype2_txt as string,",
                "          targsubtype2 as string,",
                "          targsubtype2_txt as string,",
                "          corp2 as string,",
                "          target2 as string,",
                "          natlty2 as string,",
                "          natlty2_txt as string,",
                "          targtype3 as string,",
                "          targtype3_txt as string,",
                "          targsubtype3 as string,",
                "          targsubtype3_txt as string,",
                "          corp3 as string,",
                "          target3 as string,",
                "          natlty3 as string,",
                "          natlty3_txt as string,",
                "          gname as string,",
                "          gsubname as string,",
                "          gname2 as string,",
                "          gsubname2 as string,",
                "          gname3 as string,",
                "          gsubname3 as string,",
                "          motive as string,",
                "          guncertain1 as string,",
                "          guncertain2 as string,",
                "          guncertain3 as string,",
                "          individual as string,",
                "          nperps as string,",
                "          nperpcap as string,",
                "          claimed as string,",
                "          claimmode as string,",
                "          claimmode_txt as string,",
                "          claim2 as string,",
                "          claimmode2 as string,",
                "          claimmode2_txt as string,",
                "          claim3 as string,",
                "          claimmode3 as string,",
                "          claimmode3_txt as string,",
                "          compclaim as string,",
                "          weaptype1 as string,",
                "          weaptype1_txt as string,",
                "          weapsubtype1 as string,",
                "          weapsubtype1_txt as string,",
                "          weaptype2 as string,",
                "          weaptype2_txt as string,",
                "          weapsubtype2 as string,",
                "          weapsubtype2_txt as string,",
                "          weaptype3 as string,",
                "          weaptype3_txt as string,",
                "          weapsubtype3 as string,",
                "          weapsubtype3_txt as string,",
                "          weaptype4 as string,",
                "          weaptype4_txt as string,",
                "          weapsubtype4 as string,",
                "          weapsubtype4_txt as string,",
                "          weapdetail as string,",
                "          nkill as string,",
                "          nkillus as string,",
                "          nkillter as string,",
                "          nwound as string,",
                "          nwoundus as string,",
                "          nwoundte as string,",
                "          property as string,",
                "          propextent as string,",
                "          propextent_txt as string,",
                "          propvalue as string,",
                "          propcomment as string,",
                "          ishostkid as string,",
                "          nhostkid as string,",
                "          nhostkidus as string,",
                "          nhours as string,",
                "          ndays as string,",
                "          divert as string,",
                "          kidhijcountry as string,",
                "          ransom as string,",
                "          ransomamt as string,",
                "          ransomamtus as string,",
                "          ransompaid as string,",
                "          ransompaidus as string,",
                "          ransomnote as string,",
                "          hostkidoutcome as string,",
                "          hostkidoutcome_txt as string,",
                "          nreleased as string,",
                "          addnotes as string,",
                "          scite1 as string,",
                "          scite2 as string,",
                "          scite3 as string,",
                "          dbsource as string,",
                "          INT_LOG as string,",
                "          INT_IDEO as string,",
                "          INT_MISC as string,",
                "          INT_ANY as string,",
                "          related as string",
                "     ),",
                "     deletable:false,",
                "     insertable:true,",
                "     updateable:false,",
                "     upsertable:false,",
                "     format: 'table',",
                "     skipDuplicateMapInputs: true,",
                "     skipDuplicateMapOutputs: true,",
                "     errorHandlingOption: 'stopOnFirstError') ~> gtdsink"
            ]
        }
    }
}
